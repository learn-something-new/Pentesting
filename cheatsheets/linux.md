# Linux Tricks

## Filesystem
```
mktemp                              # make an empty random file in /tmp/
mktemp -d                           # make an empty random directory in /tmp/
find . -name "*.pdf" -type f        # Find Files by Type
```

## Adding a User

```
If we need to add wheel to sudoers
# echo "%wheel        ALL=(ALL)       NOPASSWD: ALL" >> /etc/sudoers
# /usr/sbin/adduser -G wheel -s /bin/bash -d /tmp acuriousmoose
# passwd acuriousmoose
New password: abbarocks
Retype new password: abbarocks
Changing password for user acuriousmoose.
passwd: all authentication tokens updated successfully.
```

## Parsing Text

```
awk '{print $2}' [target]                             # Strip spaces from file
awk -F ',' '{print $3}' {{filename}}                  # Split on comma with AWK and print third column
sort [target] -o [output file]                        # Sort File
sort [target] -u -o [output file]                     # Sort and remove duplicates
sed '/^\s*$/d'                                        # Strip blank lines
sed -e 's/"$//' -e 's/^"//'                           # Remove quotes at beginning and end of line
wc [file]                                             # Get line count
grep -n -4 '<!--' [source]                            # Find HTML Comments
sed -r "s/\x1B\[([0-9]{1,2}(;[0-9]{1,2})?)?[mGK]//g"  # Remove ANSI Escape Codes
sed 's/,/,"/2'                                        # Replace every third comma
sed '1d' [file]                                       # Delete first line
awk '$1=$1' [file]                                    # Remove leading whitespace
```

## Comparing Files
```
comm -23 [file] [file]      # Compare files and only show only what is in the first file
comm -13 [file] [file]      # Compare files and only show only what is in the second file
comm -12 [file] [file]      # Compare files and only show only what is in both files
diff  [file] [file]         # Compare files and display differences in diff format
```

## Handy Commands
```
xxd [file]                          # Hex Dump
xxd -r [file]                       # Reverse Hex Dump
echo -n [text] | md5sum             # Create MD5 Hash
echo -n [text] | base64             # Base64 Encode
echo -n [text] | base64 --decode    # Base64 Decode
file [file]                         # Identify File Type

# Send 1M of random data via POST with Curl
dd if=/dev/urandom bs=1M count=1 | \
  curl -X POST -d @- https://example.net 

# Get Time Difference between server and local
TZ=":Europe/London" \
  python -c "import time; print time.asctime(time.gmtime(int(time.time())))"; \
  curl -si HOST | \
  grep "Date" | awk -F 'Date: ' '{print $2}'
```

## Bash Magic
```
for i in {1..5}; do echo $i; done                       # For Loop
for i in {1..5}; do echo $i; done | [another_command]   # Sequential for loop and pipe every value to a different command
while read p; do echo "$p" done <FILE                   # Loop each line in a file

# Enumerate 101 pages and only display the URL and response code for non-404 results
for i in {0..100}; \
  do curl -so /dev/null -w "%{url_effective} - %{http_code}\n" HOST/$i; \
done | grep -v "404"

curl -s HOST | grep -v '^;\|^$'                         # Curl a file and node all blank lines or lines beginning with ';'
```

## Compression
```
gzip -d [file]    # Extract gzip archive
bzip -d [file]    # Extract bzip archive
tar xfz [file]    # Extract gzipped tarball
tar xf [file]     # Extract tarball
unzip [file]      # Extract zip archive
```
