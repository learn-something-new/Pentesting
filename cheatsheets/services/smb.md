# SMB

## Scanning
```
# quick script scan against the common ports 
nmap -sU -sS -p T:139,T:445,U:137 -T5 --script 'smb-enum-*,smb-ls,smb-psexec,smb-system-info,smb-vuln*' HOST

# similar scan only specify a username and password, no guest access, and smb2
nmap -sU -sS -p T:445,U:137 --script 'smb-enum-*,smb-ls,smb-psexec,smb-system-info,smb-vuln*' --script-args 'smbusername=USER,smbpass=PASS,smbtype=v2,smbnoguest' HOST -d
```

## Browsing
```
smbclient -L\\ -I HOST -U USER -P PORT                        # List shares
smbmap -H HOST -u USER -p PASS -P PORT                        # List share permissions
smbmap -H HOST -u USER -p PASS -P PORT  -x "ipconfig /all"    # Test command execution
```

## Downloading recursively
```
smbclient '\\server\share'
smb: \> mask ""
smb: \> recurse ON
smb: \> prompt OFF
smb: \> cd 'path\to\remote\dir'
smb: \> lcd '~/path/to/download/to/'
smb: \> mget *
```
